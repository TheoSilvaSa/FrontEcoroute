<div class="grid">
    <div class="col-12 md:col-4">
        <p-card header="1. Calcular e Registrar Rota">
            <div class="p-fluid">
                <div class="field">
                    <label>ID Bairro Origem</label>
                    <input type="number" pInputText [(ngModel)]="origemId">
                </div>
                <div class="field">
                    <label>ID Bairro Destino</label>
                    <input type="number" pInputText [(ngModel)]="destinoId">
                </div>
                
                <button pButton label="Calcular Caminho Mínimo" icon="pi pi-calculator" (click)="calcularEExibir()"></button>
            </div>

            <div *ngIf="rotaCalculada" class="mt-4 p-3 border-round surface-200">
                <h5>Resultado do Cálculo:</h5>
                <p><strong>Distância:</strong> {{ rotaCalculada.distanciaTotal | number:'1.2-2' }} km</p>
                <p><strong>Trajeto:</strong> {{ rotaCalculada.caminho.join(' -> ') }}</p>

                <div class="field mt-3">
                    <label>Nomear Rota</label>
                    <input type="text" pInputText [(ngModel)]="nomeNovaRota" placeholder="Ex: Rota 1 - Norte">
                </div>

                <div class="field">
                    <label>Designar Caminhão (Placa)</label>
                    <p-dropdown [options]="caminhoesDisponiveis" 
                                optionLabel="placa" 
                                optionValue="id" 
                                [(ngModel)]="caminhaoSelecionadoId" 
                                placeholder="Selecione o Caminhão">
                    </p-dropdown>
                </div>
                
                <button pButton label="Salvar Rota" icon="pi pi-save" (click)="salvarRota()" class="p-button-success mt-2"></button>
            </div>
        </p-card>
    </div>

    <div class="col-12 md:col-8">
        <p-card header="2. Rotas Cadastradas para Agendamento">
             <p-table [value]="rotasSalvas" [rows]="5" [paginator]="true">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Rota</th>
                        <th>Caminhão</th>
                        <th>Tipo Resíduo</th>
                        <th>Distância</th>
                        <th>Sequência de Bairros</th>
                        <th>Ações</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-r>
                    <tr>
                        <td>{{r.nome}}</td>
                        <td>{{r.caminhaoDesignadoPlaca}}</td> <td>{{r.tiposResiduosAtendidos}}</td> <td>{{r.distanciaTotal | number:'1.2-2'}} km</td>
                        <td>{{r.sequenciaBairros.join(' -> ')}}</td>
                        <td>
                             <button pButton icon="pi pi-trash" class="p-button-danger p-button-rounded" (click)="deletarRota(r.id)"></button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <p *ngIf="rotasSalvas.length === 0" class="mt-3 text-center text-color-secondary">Nenhuma rota cadastrada para agendamento.</p>
        </p-card>
    </div>
</div>