<p-card header="Planejamento de Itinerários (Cronograma Mensal)">

    <div class="grid">
        <div class="col-12 md:col-4">
            <p-fieldset legend="Agendar Nova Rota">
                <div class="p-fluid">
                    
                    <div class="field">
                        <label>Rota Cadastrada</label>
                        <p-dropdown [options]="rotasSalvas" 
                                    optionLabel="nome" 
                                    optionValue="id" 
                                    [(ngModel)]="novoAgendamento.rotaId" 
                                    placeholder="Selecione a Rota">
                        </p-dropdown>
                    </div>

                    <div class="field">
                        <label>Caminhão Designado</label>
                        <p-dropdown [options]="caminhoesDisponiveis" 
                                    optionLabel="placa" 
                                    optionValue="id" 
                                    [(ngModel)]="novoAgendamento.caminhaoId" 
                                    placeholder="Selecione o Caminhão">
                        </p-dropdown>
                    </div>

                    <div class="field">
                        <label>Data da Coleta</label>
                        <p-calendar dateFormat="dd/mm/yy" 
                                    [(ngModel)]="novoAgendamento.dataAgendada" 
                                    placeholder="dd/mm/aaaa">
                        </p-calendar>
                    </div>

                    <button pButton label="Agendar Itinerário" icon="pi pi-calendar-plus" (click)="salvarItinerario()"></button>

                </div>
            </p-fieldset>
        </div>

        <div class="col-12 md:col-8">
            <p-fieldset legend="Agenda Mensal (Itinerários Agendados)">
                <p-table [value]="itinerariosAgendados" [rows]="5" [paginator]="true">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>ID Rota</th>
                            <th>Caminhão</th>
                            <th>Data</th>
                            <th>Status</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-i>
                        <tr>
                            <td>{{i.rotaDescricao || 'N/A'}}</td>
                            <td>{{i.caminhaoId}}</td>
                            <td>{{i.dataAgendada | date:'shortDate'}}</td>
                            <td>{{i.status}}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-fieldset>
            
            <p-card *ngIf="rotaCalculada" header="Detalhes da Rota" styleClass="mt-4">
                 <div class="mb-3">
                    <strong>Distância (Total):</strong> 
                    <span class="text-xl text-primary">{{ rotaCalculada?.distancia | number:'1.2-2' }} km</span>
                </div>

                <p-fieldset legend="Ordem de Visita">
                    <ol>
                        <li *ngFor="let bairro of rotaCalculada?.bairrosVisitados">
                            {{ bairro.nome }} (ID: {{ bairro.id }})
                        </li>
                    </ol>
                </p-fieldset>
            </p-card>
        </div>
    </div>
</p-card>